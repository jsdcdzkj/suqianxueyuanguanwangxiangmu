import f from"axios";export const doAuthResponseInterceptor=({client:s,doAuth:e,doRefreshToken:u,enableRefreshToken:t})=>({onRejected:async r=>{const{config:o,response:i}=r;if(i?.status!==401)throw r;if(!t||o.__noAuthToLogin)throw await e(),r;if(s.refreshing)return new Promise(n=>{s.refreshTokenQueue.push(a=>{o.headers.Authorization=a,n(s.request(o))})});s.refreshing=!0,o.__noAuthToLogin=!0;try{const n=await u();return s.refreshTokenQueue.forEach(a=>a(n)),s.refreshTokenQueue=[],s.request(o)}catch(n){throw s.refreshTokenQueue.forEach(a=>a("")),s.refreshTokenQueue=[],await e(),n}}}),doResponseInterceptor=s=>({onRejected(e){if(f.isCancel(e))return Promise.reject(e);const u=e?.toString()??"";let t="";if(u?.includes("Network Error")?t="\u7F51\u7EDC\u9519\u8BEF":e?.message?.includes?.("timeout")&&(t="\u8BF7\u6C42\u8D85\u65F6"),t)return s?.(t,e),Promise.reject(e);let r=e?.response?.data?.error?.message??"";switch(e?.response?.status){case 400:{r="\u574F\u7684\u8BF7\u6C42";break}case 401:{r="\u767B\u5F55\u72B6\u4F53\u5931\u6548";break}case 403:{r="\u670D\u52A1\u5668\u62D2\u7EDD\u8BF7\u6C42";break}case 404:{r="\u8BF7\u6C42\u5730\u5740\u672A\u627E\u5230";break}case 408:{r="\u8BF7\u6C42\u8D85\u65F6";break}default:r="\u670D\u52A1\u5668\u5F02\u5E38\u9519\u8BEF"}return s?.(r,e),Promise.reject(e)}});
