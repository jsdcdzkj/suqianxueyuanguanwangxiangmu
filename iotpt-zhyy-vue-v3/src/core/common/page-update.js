export class AbsUpdate{}export class PageUpdate{temp=+new Date;requestFrameId=-1;onceUpdateList=[];updateList=[];_update(t){this._emitUpdateOnce(t),this._emitUpdate(t)}_emitUpdateOnce(t){for(let e=this.onceUpdateList.length-1;e>=0;e--){const[i]=this.onceUpdateList.splice(e,1);i&&i(t)}}_emitUpdate(t){for(let e=this.updateList.length-1;e>=0;e--)this.updateList[e](t)}stop(){this.requestFrameId!=-1&&cancelAnimationFrame(this.requestFrameId)}addUpdateListener(t){this.updateList.find(i=>i===t)||this.updateList.push(t)}addUpdateOnceListener(t){this.onceUpdateList.find(i=>i===t)||this.onceUpdateList.push(t)}removeUpdateListener(t){const e=this.updateList.findIndex(i=>i===t);e>-1&&this.updateList.splice(e,1)}removeUpdateOnceListener(t){const e=this.onceUpdateList.findIndex(i=>i===t);e>-1&&this.onceUpdateList.splice(e,1)}start(){this.temp=+new Date,this.requestFrameId=requestAnimationFrame(()=>{const t=+new Date-this.temp;this._update(t/1e3),this.start()})}removeAll(){this.updateList=[],this.onceUpdateList=[]}destroy(){this.stop(),this.requestFrameId=-1,this.removeAll()}}
